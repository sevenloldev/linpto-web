---
// Assets
import { Image } from "astro:assets";
import HeroImage from "@/images/assets/heroImage.png";

// Fundations
import Text from "@/components/fundations/elements/Text.astro";
import Wrapper from "@/components/fundations/containers/Wrapper.astro";
// Content
import { getCollection } from "astro:content";
const { inverted = true } = Astro.props;
const triggerColor = inverted ? "text-white" : "text-base-800";

// Dynamic content from collections
const allPosts = (await getCollection("posts"))
  .sort((a, b) => new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime())
  .slice(0, 2);
const allCases = (await getCollection("cases"))
  .sort((a, b) => new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime());
const featuredCase = allCases[0];

const exploreLinks = [
  { label: "專業領域", href: "/practice-areas" },
  { label: "實務案例", href: "/cases" },
  { label: "律師團隊", href: "/team" },
  { label: "法律專欄", href: "/blog" },
  { label: "人才招募", href: "/careers" },
  { label: "媒體報導", href: "/press-and-media" },
  { label: "據點資訊", href: "/offices" },
  { label: "聯絡我們", href: "/contact" },
  { label: "免費法律諮詢", href: "/free-consultation" },
  { label: "新聞稿", href: "/press-releases" },
  { label: "客戶推薦", href: "/testimonials" },
  { label: "電子報", href: "/newsletter" },
];
---

<div class="group" data-mega-wrap>
  <button
    type="button"
    class={`flex text-sm items-center gap-1 ${triggerColor} focus:outline-none`}
    aria-expanded="false"
    aria-controls="mega-desktop"
    data-mega-trigger
    data-explore-trigger
  >
    <span>探索</span>
    <svg
      class="size-4 transition-transform group-hover:rotate-180"
      viewBox="0 0 24 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M6 9l6 6 6-6"
        stroke="currentColor"
        stroke-width="1.5"
        stroke-linecap="round"
        stroke-linejoin="round"></path>
    </svg>
  </button>
  <div
    id="mega-desktop"
    data-mega-panel
    class="absolute inset-x-0 mt-2 top-full w-full z-50 invisible opacity-0 pointer-events-none transition-opacity duration-150 lg:group-hover:visible lg:group-hover:opacity-100 lg:group-hover:pointer-events-auto lg:group-focus-within:visible lg:group-focus-within:opacity-100 lg:group-focus-within:pointer-events-auto"
  >
    <Wrapper>
      <div
        class="bg-accent-900 overflow-hidden shadow-xl border border-white/5"
      >
        <div class="grid grid-cols-4 items-start divide-x divide-white/10">
          <div class="p-6 h-full">
            <div class="flex flex-col h-full items-start">
              <Image
                src={HeroImage}
                width={600}
                height={600}
                alt="翰霖法律事務所"
                class="object-cover object-top w-full h-40 rounded-lg"
                loading="eager"
                decoding="async"
              />
              <Text
                tag="h2"
                variant="textXL"
                class="font-display text-white mt-4"
              >
                關於翰霖法律事務所
              </Text>
              <Text tag="p" variant="textSM" class="text-base-600 mt-2">
                翰霖法律事務所致力於為客戶提供專業的法律策略與堅定的權益維護。我們的團隊擁有豐富經驗，為企業與個人提供全方位法律服務。
              </Text>
              <div
                class="w-full mt-4 pt-4 border-t border-white/10 space-y-2 flex flex-col"
              >
                <a
                  href="mailto:service@linpto.com.tw"
                  class="text-base-300 hover:text-white transition-colors text-xs"
                >
                  service@linpto.com.tw
                </a>
                <a
                  href="tel:+886225852626"
                  class="text-base-300 hover:text-white transition-colors text-xs"
                >
                  02-2585-2626
                </a>
                <a
                  href="/contact"
                  class="text-xs text-white hover:text-accent-400 transition-colors"
                >
                  聯絡我們
                </a>
              </div>
            </div>
          </div>
          <div class="p-6 h-full">
            <Text tag="h3" variant="textXS" class="text-secondary-400 gap-2">
              探索
            </Text>
            <ul class="space-y-2 mt-2 pt-2 border-t border-white/10">
              {
                exploreLinks.slice(0, 8).map((explore) => (
                  <li class=" group">
                    <a href={explore.href}>
                      <Text
                        tag="h4"
                        variant="textSM"
                        class=" text-base-200 hover:text-secondary-500"
                      >
                        {explore.label}
                      </Text>
                    </a>
                  </li>
                ))
              }
            </ul>
          </div>
          <div class="p-6 h-full flex flex-col justify-between">
            <div>
              <Text tag="h3" variant="textXS" class="text-secondary-400 gap-2">
                最新文章
              </Text>
              <ul class="mt-2 pt-2 border-t border-white/10">
                {
                  allPosts.map((post) => (
                    <li class="py-2 group">
                      <a
                        href={`/blog/posts/${post.slug}`}
                        aria-label={`閱讀：${post.data.title}`}
                      >
                        <Text
                          tag="h4"
                          variant="textSM"
                          class="font-medium text-base-200"
                        >
                          {post.data.title}
                        </Text>
                        <Text
                          tag="p"
                          variant="textXS"
                          class="text-base-600 mt-1"
                        >
                          {post.data.description}
                        </Text>
                      </a>
                    </li>
                  ))
                }
              </ul>
            </div>
            <a
              href="/blog"
              class="text-sm text-white hover:text-accent-400 flex mt-4 pt-4 border-t border-white/10"
            >
              查看所有文章
            </a>
          </div>
          <div class="p-6 h-full flex flex-col justify-between">
            <div>
              <Text tag="h3" variant="textXS" class="text-secondary-400 gap-2">
                精選案例
              </Text>
              {featuredCase && (
                <ul class="mt-2 pt-2 border-t border-white/10">
                  <li class="py-2 group">
                    <a
                      href={`/cases/${featuredCase.slug}`}
                      aria-label={`查看案例：${featuredCase.data.title}`}
                    >
                      <Text
                        tag="h4"
                        variant="textSM"
                        class="font-medium text-base-200"
                      >
                        {featuredCase.data.title}
                      </Text>
                      <Text tag="p" variant="textXS" class="text-base-600 mt-1">
                        {featuredCase.data.description}
                      </Text>
                      <Text tag="p" variant="textXS" class="text-base-600 mt-1">
                        {featuredCase.data.practice}
                      </Text>
                    </a>
                  </li>
                </ul>
              )}
            </div>

            <a
              href="/cases"
              class="text-sm text-white hover:text-accent-400 flex mt-4 pt-4 border-t border-white/10"
            >
              查看所有案例
            </a>
          </div>
        </div>
      </div>
    </Wrapper>
  </div>
</div>
